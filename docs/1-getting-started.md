# Getting started

### Read this first

AnyStream is a private streaming service for your media files. Third party APIs and optional external applications are
used to improve the quality of your collection. You are responsible for operating any external applications that
AnyStream communicates with while managing your collection.

**To maintain privacy it is recommended that you run AnyStream with a VPN like [AirVPN](https://airvpn.org/)
or [Mullvad](https://mullvad.net/).**

## Installation

[anystream-server.zip](https://github.com/DrewCarlson/AnyStream/releases/download/v{{ version }}/anystream-server-{{ version }}.zip)

[Download](https://github.com/DrewCarlson/AnyStream/releases) the latest `anystream-server` release. AnyStream binaries
are not operating system specific, the one download will run on Linux, macOS, or Windows.

After downloading `anystream-server-<version>.zip` or `anystream-server-<version>.tar`, extract the contents
to `anystream-<version>`. The new folder will contain `bin` and `lib`.

AnyStream tries to provide optimal default configuration and can be run without any configuration.

??? info "Configuration (Environment variables)"

    The following optiions can be modified on your first run to customize AnyStream for your system.
    
    | name              | value                                                                                                            | description                                                                                                             |
    |-------------------|------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
    | `PORT`            | `8888`                                                                                                           | The port used to serve the web client and API.                                                                          |
    | `DATA_PATH`       | macos = `/Users/<user>/anystream`<br/>linux = `/home/<user>/anystream`<br/>windows = `C:\Users\<user>\anystream` | The folder where all data generated by anystream will be stored. Note this is not the folder for your media collection. |
    | `DATABASE_URL`    | `sqlite:<DATA_PATH>/config/anystream.db`                                                                         | The file where the database will be stored. (Note the `sqlite:` prefix is required)                                     |
    | `FFMPEG_PATH`     | macos = `/usr/bin`<br/>linux = `/usr/bin`<br/>windows = `C:\Program Files\ffmpeg`                                | The directory which contains [FFmpeg](https://www.ffmpeg.org/download.html) and FFprobe binaries.                       |
    | `WEB_CLIENT_PATH` | (none)                                                                                                           | The folder which contains the Web client files to be served. By default these files are provided by the server binary.  |

??? info "Configuration (Program arguments)"

    If preferred, AnyStream accepts arguments instead of Environment variables.
    The table below maps the Environment variable name to the CLI argument, see "Configuration (Environment variables)" for descriptions of each option.
    
    | Env Name          | CLI Argument               |
    |-------------------|----------------------------|
    | `PORT`            | `-port=8888`               |
    | `DATA_PATH`       | `-app.dataPath="..."`      |
    | `DATABASE_URL`    | `-app.databaseUrl="..."`   |
    | `FFMPEG_PATH`     | `-app.ffmpegPath="..."`    |
    | `WEB_CLIENT_PATH` | `-app.webClientPath="..."` |

### Requirements

When installing without [Podman](https://podman.io/) or [Docker](https://www.docker.com/), extra software is required
before running AnyStream.

??? note "Manual install requirements"

    **Java Runtime 11+**
    
    [JRE 11+](https://www.azul.com/downloads/?version=java-11-lts&package=jre) is required to run AnyStream.
    
    **FFmpeg**
    
    [FFmpeg](https://ffmpeg.org/) is required to [transcode](https://en.wikipedia.org/wiki/Transcoding) your media library
    when streaming to certain devices and analyzing media files.

### Windows

Open the `anystream-<version>/bin` folder and run `anystream.bat`. A new command prompt window will appear and display
print log messages while running.

Or open a new Command Prompt window:

??? info "anystream.bat from Command Prompt example"

    ```shell
    cd anystream-<version>/bin
    
    anystream -port=8888 -P:app.ffmpegPath="C:\Users\<user>\Downloads\ffmpeg"
    ```

### Linux & macOS

??? info "anystream from Terminal example"

    ```shell
    cd anystream-<version>/bin
    
    ./anystream -port=8888
    ```

### Docker CLI

A small Alpine based docker image is provided
at [ghcr.io/drewcarlson/anystream](https://github.com/DrewCarlson/AnyStream/pkgs/container/anystream).

??? example "Docker CLI example"

    ```shell
    docker run -d --name anystream \
        -v /path/to/anystream:/app/storage \
        -v /path/to/media:/app/media \
        -p 8888:8888 \
        ghcr.io/drewcarlson/anystream:main
    ```

### Docker Compose

Create a `docker-compose.yml` copy one of the following examples:

??? example "Without qBittorrent"

    ```yaml
    version: '3.1'
    services:
      anystream:
        container_name: anystream
        image: ghcr.io/drewcarlson/anystream:main
        restart: unless-stopped
        ports:
          - "8888:8888"
        volumes:
          - /path/to/anystream:/app/storage
          - /path/to/media:/app/media
    ```

??? example "With qBittorrent"

    ```yaml
    version: '3.1'
    services:
      anystream:
        container_name: anystream
        image: ghcr.io/drewcarlson/anystream:main
        restart: unless-stopped
        ports:
          - "8888:8888"
        environment:
          QBT_URL: http://qbittorrent:9090
          QBT_USER: admin
          QBT_PASSWORD: adminadmin
        volumes:
          - /path/to/anystream:/app/storage
          - /path/to/media:/app/media
          - /path/to/qbittorrent/downloads:/app/downloads
        links:
          - qbittorrent
        depends_on:
          - qbittorrent
    
      qbittorrent:
        image: drewcarlson/docker-qbittorrentvpn
        container_name: qbittorrent
        restart: unless-stopped
        cap_add:
          - NET_ADMIN
        sysctls:
          - net.ipv6.conf.all.disable_ipv6=0
        privileged: true
        environment:
          - VPN_ENABLED=yes
          - NAME_SERVERS=1.1.1.1,8.8.8.8
          - WEBUI_PORT=9090
          - TZ=America/Los_Angeles
          - UMASK_SET=022
        volumes:
          - /path/to/qbittorrent/config:/config
          - /path/to/qbittorrent/downloads:/downloads
          - /path/to/media:/content
    ```

Start the stack:

```shell
docker-compose up -d
```

## Setup AnyStream

Assuming your instance started without errors, the web client will be available
at [localhost:8888](https://localhost:8888).

### Create an Admin User

After starting a new AnyStream instance, the first user signup does not require an invitation code and will be granted
global permissions.

!!! danger

    It is important to register an admin user immediately after starting AnyStream for the first time.
    If left incomplete, unauthorized users my be able to modify system files via AnyStream.

### Importing Media

### Inviting Users

Navigate to Settings > Users, then click "Manage Invites". Select the permissions required by the new User, then click
"Create Invite". The new invite will be added to the list and a sharable signup link will be copied to your clipboard.

